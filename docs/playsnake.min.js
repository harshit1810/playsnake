(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(){return{setupGame:function(t){var n,r,i,o={FlexCols:{display:"flex","flex-direction":"row"},CapitalizeText:{"text-transform":"capitalize"},ZeroPixels:t.pixelify(0),Padding:t.pixelify(5)},a=t.getDocument().getElementById.bind(t.getDocument()),s=t.getConfig(),u=s.id,c=s.arenaContainerId,d=s.directionMap,l=s.pauseButton,g=s.resumeButton,f=s.quitButton,y=s.game,p=y.scoreBoard,h=y.infoContainerId,m=y.legendContainerId,v=s.eatables,b=void 0===v?{}:v,E=Object.keys(d).reduce((function(e,t){return e[d[t]]=t,e}),{UP:null,DOWN:null,RIGHT:null,LEFT:null}),S=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.addEventListener("click",t),e.addEventListener("touchstart",t,n)},x=a(u),k=(n=l.id,r=a(n),S(r,(function(){t.getGameEvents().emit("PAUSE_BUTTON_CLICKED")})),r),I=function(e){var n=a(e);return S(n,(function(){t.getGameEvents().emit("RESUME_BUTTON_CLICKED")})),n}(g.id);!function(e){var n=a(e);S(n,(function(){t.getGameEvents().emit("STOP_GAME")}))}(f.id),i=a(m),Object.keys(b).forEach((function(e){var n=b[e],r=n.description,a=n.showInLegend,s=n.color,u=void 0===s?"white":s;if(a&&r){var c=t.createHTMLElement({parent:i,elementType:"div",attributes:{class:"cols universal-padding",style:t.getStyleString(Object.assign({},{"align-items":"center"}))}});t.createHTMLElement({parent:c,elementType:"div",attributes:{style:t.getStyleString({height:t.pixelify(10),width:t.pixelify(10),"background-color":u,"border-radius":t.pixelify(5)})}}),t.createHTMLElement({parent:c,elementType:"span",innerHTML:r,attributes:{style:t.getStyleString(Object.assign({},o.CapitalizeText,{padding:"".concat(o.ZeroPixels," ").concat(t.pixelify(2))}))}})}})),T={},A=function(){T={}},C=a(c),B=function(e){t.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:e}),A()},C.addEventListener("touchstart",(function(e){e.preventDefault(),e.targetTouches&&e.targetTouches.length>0&&(T.x=parseInt(e.targetTouches[0].clientX),T.y=parseInt(e.targetTouches[0].clientY))})),C.addEventListener("touchmove",(function(){})),C.addEventListener("touchend",(function(e){var t=T,n=t.x,r=t.y,i=e.changedTouches[0],o=i.clientX,a=i.clientY,s=[parseInt(o),parseInt(a)],u=s[0],c=s[1],d=u-n,l=c-r;if((n!==u||r!==c)&&Math.abs(d)!==Math.abs(l))return 0===d?B(l>0?E.DOWN:E.UP):0===l?B(d>0?E.RIGHT:E.LEFT):d>0&&Math.abs(d)>Math.abs(l)?B(E.RIGHT):d<0&&Math.abs(d)>Math.abs(l)?B(E.LEFT):l>0&&Math.abs(l)>Math.abs(d)?B(E.DOWN):l<0&&Math.abs(l)>Math.abs(d)?B(E.UP):void 0})),C.addEventListener("touchcancel",A);var T,A,C,B,w,D,O,M,L,N,G,_,H,F,R=a(p.id),P=(H=["modal-container","modal-content-btn-1","modal-content-btn-2","modal-content","modal-content-btns-container"].map(a),F=5,w=function(e){if(Array.isArray(e))return e}(H)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(H,F)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(H,F)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),D=w[0],O=w[1],M=w[2],L=w[3],N=w[4],G=[],{show:function(e){var n=e.elementIds,r=void 0===n?[]:n,i=e.texts,o=void 0===i?[]:i,s=e.btn1,u=e.btn2;s=s||{},u=u||{},r=Array.isArray(r)?r:[r],o=Array.isArray(o)?o:[o],r.forEach((function(e){if(e){var t=a(e).cloneNode(!0);G.push(t),L.insertBefore(t,N)}})),o.forEach((function(e){return G.push(t.createHTMLElement({elementType:"p",parent:L,innerHTML:e,beforeElement:N,attributes:{class:"text-center"}}))})),O.innerHTML=s.label?s.label:O.innerHTML,M.innerHTML=u.label?u.label:M.innerHTML,O.style.display="boolean"==typeof s.show?s.show?"block":"none":O.style.display,M.style.display="boolean"==typeof u.show?u.show?"block":"none":M.style.display,"function"==typeof s.clickHandler&&S(O,s.clickHandler,{once:!0}),"function"==typeof u.clickHandler&&S(M,u.clickHandler,{once:!0}),S(O,_,{once:!0}),S(M,_,{once:!0}),D.style.display="block"},hide:_=function(){D.style.display="none",G.forEach((function(e){return e.remove()})),O.innerHTML="no",M.innerHTML="yes",O.style.display="block",M.style.display="block"}});return S(a(h),(function(){return t.getGameEvents().emit("SHOW_GAME_INFO")})),{SNAKE_ARENA:x,PLAY_BUTTON:I,PAUSE_BUTTON:k,SCORE_BOARD:R,MODAL:P}},onWindowLoad:function(e){var t=e.arenaId,n=e.arenaContainerId,r=function(e){return Math.floor(String(e).trim().split("px")[0])},i=document.getElementById(n),o=document.getElementById(t),a=r(window.getComputedStyle(i).maxWidth),s=r(window.getComputedStyle(i).width),u=s>a?a:s,c=u;return o.setAttribute("width",u),o.setAttribute("height",c),{ARENA_WIDTH:u,ARENA_HEIGHT:c}}}}function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=function(){var e,r,o,a,s,u,c,d,l=t().onWindowLoad,g="arena-section",f="play-snake-arena",y={DEFAULT:"Sorry.",SETUP_GAME:"Failed to setup",START_GAME:"Unable To Start The Game",INACTIVITY_TIMEOUT:"It seems you are not playing",GAME_OVER:"Game Over",Q_CONTINUE:"Continue?"},p=(14,{id:f,arenaContainerId:g,width:r=(e=l({arenaId:f,arenaContainerId:g})).ARENA_WIDTH,height:o=e.ARENA_HEIGHT,borderColor:"black",borderWidth:1,limits:a={x1:2,y1:2,x2:r-2,y2:o-2},supportedKeys:[37,38,39,40],arena:{center:{x:Math.floor(r/2),y:Math.floor(o/2)}},directionMap:{37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},keyConfig:{37:{reverse:39},38:{reverse:40},39:{reverse:37},40:{reverse:38}},game:{legendContainerId:"legend-container",infoContainerId:"game-info",inactivityTimeout:300,state:{paused:0,stopped:1,playing:2},scoreBoard:{id:"score"},scoreCheckpointMultipleOf:50},pauseButton:{id:"pause-play-snake"},resumeButton:{id:"resume-play-snake"},quitButton:{id:"quit-play-snake"},snake:{id:"the-snake",elemType:"circle",width:14,color:"black",length:1,speed:12,step:1,turboSpeed:3},eatables:{eatableRadius:7,limits:{x1:a.x1+14,y1:a.y1+14,x2:a.x2-14,y2:a.y2-14},basicFood:{id:"the-snake-food",color:"#aba99f",description:"Basic food",showInLegend:!0,points:5,appearDuration:null,startAfter:0,elemType:"circle",size:7,isIntervalBased:!1,code:"basicFood",growSnakeIfConsumed:!0,growSnakeByLength:1},bonusFood:{id:"the-snake-bonus-food",color:"#d12308",description:"Bonus point",showInLegend:!0,points:10,appearDuration:10,startAfter:30,elemType:"circle",size:7,isIntervalBased:!0,code:"bonusFood",growSnakeIfConsumed:!1,growSnakeByLength:2},speedBonus:{id:"the-speed-bonus",color:"#ffe205",description:"Turbo boost",showInLegend:!0,points:0,appearDuration:10,startAfter:30,elemType:"circle",size:7,speedDuration:10,isIntervalBased:!0,code:"speedBonus",growSnakeIfConsumed:!1,growSnakeByLength:0}}}),h={},m={RENDER_UNIT:"px",getSvgNamespace:function(){return"http://www.w3.org/2000/svg"},getWindow:function(){return window},getDocument:function(){return this.getWindow().document},getDocumentBody:function(){return this.getDocument().body},getConfig:function(){return p},getGame:function(){return s},getDirectionCommands:function(){return u},getSnakeDirectionMap:function(){return h},pixelify:function(e){return String(e).trim().concat(this.RENDER_UNIT)},getStyleString:function(e){return Object.keys(e||{}).reduce((function(t,n){if(!n||!String(n).trim().length)return t;n=String(n).trim();var r=e[n];return String(r).trim().length?(r=String(r).trim(),t.concat(" ".concat(n,": ").concat(r,";"))):t}),"")},createHTMLElement:function(e){var t=e.elementType,n=e.innerHTML,r=e.attributes,o=void 0===r?{}:r,a=e.eventListeners,s=void 0===a?{}:a,u=e.elementNamespace,c=e.parent,d=e.beforeElement;c||(c=m.getDocumentBody());var l=u?this.getDocument().createElementNS(u,t):this.getDocument().createElement(t);return"object"===i(o)&&Object.keys(o).forEach((function(e){return l.setAttribute(e,o[e])})),n&&(l.innerHTML=String(n)),d?c.insertBefore(l,d):c.appendChild(l),"object"===i(s)&&Object.keys(s).forEach((function(e){return l.addEventListener(e,s[e])})),l},getGameEvents:function(){return A},checkBoundaryPosition:function(e,t){var n=this.getConfig().limits;switch(e){case 37:t.x<n.x1&&(t.x=n.x2);break;case 38:t.y<n.y1&&(t.y=n.y2);break;case 39:t.x>n.x2&&(t.x=n.x1);break;case 40:t.y>n.y2&&(t.y=n.y1)}return t},getDisplayMessages:function(){return y},intersectingOnXAxis:function(e,t){return t.x1<=e.x1&&e.x1<=t.x2||t.x1<=e.x2&&e.x2<=t.x2||e.x1<=t.x1&&t.x1<=e.x2||e.x1<=t.x2&&t.x2<=e.x2},intersectingOnYAxis:function(e,t){return t.y1<=e.y1&&e.y1<=t.y2||t.y1<=e.y2&&e.y2<=t.y2||e.y1<=t.y1&&t.y1<=e.y2||e.y1<=t.y2&&t.y2<=e.y2},getRandomInRange:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},LOGGER:{log:console.log,error:console.error,warn:console.warn}};c={id:Date.now(),direction:m.getConfig().supportedKeys[2],position:{x:m.getConfig().arena.center.x,y:m.getConfig().arena.center.y}},d=[],c&&d.push(c),u={add:function(e){var t=d[d.length-1];t&&t.position.x==e.position.x&&t.position.y==e.position.y?t.direction=e.direction:d.push(e)},getFirst:function(){return d[0]},remove:function(){d.shift()},clear:function(){d.splice(0,d.length)},hasCommands:function(){return d.length>0},getNextTurn:function(e){var t=m.getSnakeDirectionMap();if(void 0===t[e])return this.getFirst();var n=d.findIndex((function(n){return n.id===t[e]}));return n==d.length-1?void 0:d[n+1]}};var v,b,E,S,x,k,I,T,A=function(){var e,t={PAUSE_BUTTON_CLICKED:[function(){return e.pause()}],RESUME_BUTTON_CLICKED:[function(){return e.resume()}],STOP_GAME:[function(){return e.stop()}],EATABLE_CONSUMED:[function(e){return e.hide()},function(e){return n("UPDATE_SCORE",e.points)},function(t){return e.growSnake(t)},function(e){return e.isIntervalBased?void 0:n("DROP_EATABLE",e)}],UPDATE_SCORE:[function(t){return e.updateScore(t)}],USE_SPEED_BONUS:[function(){return e.increaseSnakeSpeed()}],DEVOURED_SELF:[function(){return n("STOP_GAME")}],SNAKE_DIRECTION_CHANGE:[function(t){var n=t.direction;return e.handleSnakeDirectionChange(parseInt(n))}],SHOW_GAME_INFO:[function(){return e.showGameInfo()}],SCORE_CHECKPOINT:[function(t){return e.processScoreCheckpoint(t)}],DROP_EATABLE:[function(t){return e.dropEatable(t)}]};function n(e,n){t.hasOwnProperty(e)?t[e].forEach((function(e){return e(n)})):console.warn("Invalid event triggered : ".concat(e))}return{init:function(t){return e=t},emit:n,listen:function(e,n){Array.isArray(t[e])?t[e].push(n):t[e]=[n]},destruct:function(){return t={}}}}(),C=(v=m,b=function(e){var t=e.getConfig();function n(n,r){var i,o,a,s,u,c;r=r||[{x1:0,x2:0},{y1:0,y2:0}];var d=t.eatables.eatableRadius;do{var l=[e.getRandomInRange(n.x1,n.x2),e.getRandomInRange(n.y1,n.y2)];a=(i=l[0])-(d-1),s=(o=l[1])-(d-1),u=i+(d-1),c=o+(d-1)}while(r.every((function(t){!e.intersectingOnXAxis({x1:a,x2:u},{x1:t.x1,x2:t.x2})&&e.intersectingOnYAxis({y1:s,y2:c},{y1:t.y1,y2:t.y2})})));return{x:i,y:o}}return{getNextEatablePosition:n,createEatableItem:function(r,i,o,a){if(!t.eatables[a])return e.LOGGER.warn("item ".concat(a," is not configured"));var s,u=t.eatables.limits,c=t.eatables[a],d=c.id,l=c.elemType,g=c.color,f=c.size,y=c.isIntervalBased,p=c.startAfter,h=c.points,m=c.appearDuration,v=c.growSnakeIfConsumed,b=c.growSnakeByLength,E=e.createHTMLElement({elementType:l,elementNamespace:e.getSvgNamespace(),attributes:{id:d,cx:i,cy:o,r:f,fill:g},parent:e.getGame().arena,beforeElement:e.getGame().getSnake().head.element}),S=f,x=!0;return{radius:S,get isIntervalBased(){return y},get element(){return E},get arena(){return r},get intervalId(){return s},set intervalId(e){s=e},get startAfter(){return p},get x(){return this.getCenter().x-(S-1)},get y(){return this.getCenter().y-(S-1)},get x2(){return this.getCenter().x+(S-1)},get y2(){return this.getCenter().y+(S-1)},get points(){return parseInt(h)},get appearDuration(){return m},get growSnakeIfConsumed(){return v},get growSnakeByLength(){return b},get isHidden(){return x},set isHidden(e){x=e},getCode:function(){return a},getCenter:function(){return{x:parseInt(this.element.getAttribute("cx")),y:parseInt(this.element.getAttribute("cy"))}},setCenter:function(e){var t=e.x,n=e.y;this.element.setAttribute("cx",t),this.element.setAttribute("cy",n)},startInterval:function(){var t=this;if(t.isIntervalBased)return t.intervalId=setInterval((function(){return e.getGameEvents().emit("DROP_EATABLE",t)}),1e3*t.startAfter),t.intervalId},drop:function(){var e=this,t=n(u,arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]),r=t.x,i=t.y;e.setCenter({x:r,y:i}),e.isHidden=!1,"number"==typeof e.appearDuration&&setTimeout(e.hide.bind(e),1e3*e.appearDuration)},hide:function(){this.setCenter({x:-10,y:-10}),this.isHidden=!0}}}}}(v),E=b.createEatableItem,S=b.getNextEatablePosition,x=function(e){var t=e.getConfig(),n=t.snake,r=n.elemType,i=n.color,o=n.width,a=n.step,s=n.id;function u(t,n,u,c,d){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:i,g=1===d,f="".concat(s,"-part").concat(d),y=o/2,p=n+(y-1),h=u+(y-1),m=e.createHTMLElement({elementNamespace:e.getSvgNamespace(),elementType:r,attributes:{id:f,cx:p,cy:h,r:y,fill:l},parent:t}),v=c,b=null,E=null;return{id:f,element:m,color:l,radius:y,get direction(){return v},set direction(e){v=e},get next(){return b},get prev(){return E},set next(e){b=e},set prev(e){E=e},get x(){return this.getCenter().x-(y-1)},set x(e){m.setAttribute("cx",e+(y-1))},get y(){return this.getCenter().y-(y-1)},set y(e){m.setAttribute("cy",e+(y-1))},get x2(){return this.getCenter().x+(y-1)},get y2(){return this.getCenter().y+(y-1)},get isHead(){return g},isTail:function(){return f===e.getGame().getSnake().tail.id},getCenter:function(){return{x:parseInt(this.element.getAttribute("cx")),y:parseInt(this.element.getAttribute("cy"))}},nextXY:function(){var t=this,n={x:t.x,y:t.y};switch(t.direction){case 37:n.x-=a;break;case 38:n.y-=a;break;case 39:n.x+=a;break;case 40:n.y+=a}e.checkBoundaryPosition(t.direction,n),t.x=n.x,t.y=n.y;var r=e.getDirectionCommands();if(r.hasCommands()){var i=r.getNextTurn(f),o=t.getCenter();i&&i.position.x==o.x&&i.position.y==o.y&&(t.direction=i.direction,e.getSnakeDirectionMap()[f]=i.id,t.isTail()&&r.remove())}}}}return{Snake:function(n,r,s,c,d){var l,g=1,f=i,y=c,p=u(n,r,s,y,g),h=p,m=[p];return{get arena(){return n},set arena(e){n=e},get length(){return g},set length(e){return g=e},get head(){return p},set head(e){return p=e},get tail(){return h},set tail(e){return h=e,this.length+=1,h},get intervalId(){return l},set intervalId(e){l=e},get currentDirection(){return y},set currentDirection(e){y=e},get speed(){return d},set speed(e){d=e},get color(){return f},set color(e){f=e},get bodyParts(){return m},startSnake:function(e){var t=this;return e="number"==typeof e?e:this.speed,t.intervalId=setInterval((function(){t.changeDirection(t.currentDirection),t.start()}),e),t.intervalId},changeDirection:function(e){this.head.direction="number"==typeof e?e:this.currentDirection},start:function(){switch(t.directionMap[this.head.direction]){case"UP":this.move(0,-1*a);break;case"DOWN":this.move(0,a);break;case"RIGHT":this.move(a,0);break;case"LEFT":this.move(-1*a,0)}},getPositionOfNewPart:function(){var e=this.tail,t=e.x,n=e.y,r=e.direction,i=[Number(t),Number(n)],a=i[0],s=i[1];switch(r){case 37:a=t+o;break;case 38:s=n+o;break;case 39:a=t-o;break;case 40:s=n-o}return{x:a,y:s}},grow:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,n=1;n<=e;n++){var r=t.getPositionOfNewPart(),i=r.x,o=r.y;t.bodyParts.push(u(t.arena,i,o,t.tail.direction,t.length+1));var a=t.bodyParts[t.bodyParts.length-1];t.tail.next=a,a.prev=t.tail,t.tail=a}},changeColor:function(e){for(var t=this.head,n=function(e,t){setTimeout((function(){return e.color=t}),0)};null!==t.next;)n(t,e),t=t.next},isEatingEatable:function(t){return e.intersectingOnXAxis({x1:this.head.x,x2:this.head.x2},{x1:t.x,x2:t.x2})&&e.intersectingOnYAxis({y1:this.head.y,y2:this.head.y2},{y1:t.y,y2:t.y2})},move:function(n,r){var i=this;if(this.isDevouringSelf())e.getGameEvents().emit("DEVOURED_SELF");else{var o=this.head,a=e.checkBoundaryPosition(o.direction,{x:o.x+n,y:o.y+r}),s=a.x,u=a.y;o.x=s,o.y=u,[e.getGame().getBasicFood(),e.getGame().getSnakeBonusFood(),e.getGame().getSpeedBonusFood()].map((function(n){i.isEatingEatable(n)&&(e.getGameEvents().emit("EATABLE_CONSUMED",n),n.getCode()===t.eatables.speedBonus.code&&e.getGameEvents().emit("USE_SPEED_BONUS",e.getGame().getSpeedBonusFood()))})),this.moveAllParts()}},moveAllParts:function(){1===this.length&&e.getDirectionCommands().clear();for(var t=this.bodyParts,n=0;n<t.length;n++)t[n].isHead||t[n].nextXY()},isDevouringSelf:function(){var e=!1;if(this.length<=2)return e;for(var t=this.head.next.next,n=this.head.getCenter(),r=n.x,i=n.y;null!==t&&!e;){var o=t.getCenter(),a=o.x,s=o.y,u=a-(t.radius-1),c=a+(t.radius-1),d=s-(t.radius-1),l=s+(t.radius-1);e=u<=r&&r<=c&&d<=i&&i<=l,t=t.next}return e}}}}}(v).Snake,k=v.getConfig(),I=t().setupGame,T=v.getDisplayMessages(),{PlaySnake:function(){var e,t,r,i,o;try{var a=I(v);e=a.SNAKE_ARENA,t=a.PLAY_BUTTON,r=a.PAUSE_BUTTON,i=a.SCORE_BOARD,o=a.MODAL}catch(e){throw new Error(T.SETUP_GAME)}var s,u,c,d,l,g,f=k.game.state.playing,y={playButton:t,pauseButton:r,scoreBoard:i};return{get snake(){return s},set snake(e){s=e},get snakeFood(){return u},set snakeFood(e){u=e},get snakeBonusFood(){return c},set snakeBonusFood(e){c=e},get speedBonus(){return d},set speedBonus(e){d=e},get snakeDirection(){return l},set snakeDirection(e){l=e},get arena(){return e},get state(){return f},set state(e){f=e},getSnake:function(){var e=this;if(e.snake)return e.snake;var t=v.getDirectionCommands().getFirst(),n=t.direction,r=t.position,i=r.x,o=r.y;return e.snakeDirection=n,e.snake=x(e.arena,i,o,e.snakeDirection,k.snake.speed),e.snake},getSpeedBonusFood:function(){var e=this;return e.speedBonus||(e.speedBonus=E(e.arena,-10,-10,k.eatables.speedBonus.code)),e.speedBonus},getBasicFood:function(){var e=this;if(e.snakeFood)return e.snakeFood;var t=S(k.eatables.limits),n=t.x,r=t.y;return e.snakeFood=E(e.arena,n,r,k.eatables.basicFood.code),e.snakeFood},getSnakeBonusFood:function(){var e=this;return e.snakeBonusFood||(e.snakeBonusFood=E(e.arena,-10,-10,k.eatables.bonusFood.code)),e.snakeBonusFood},getEatables:function(e){var t=(e||{}).hidden,n=void 0!==t&&t;return[this.getBasicFood(),this.getSnakeBonusFood(),this.getSpeedBonusFood()].reduce((function(e,t){return!n&&t.hidden||e.push(t),e}),[])},start:function(){var e=this;try{e.getSnake().startSnake();var t=e.getBasicFood();setTimeout(1e3*k.eatables.basicFood.startAfter,t),e.getSnakeBonusFood().startInterval(),e.getSpeedBonusFood().startInterval(),e.setButtonListeners()}catch(t){throw e.showModal({modalConfig:{texts:T.START_GAME,btn1:{show:!1},btn2:{label:"ok"}}}),t}},growSnake:function(e){e&&e.growSnakeIfConsumed&&this.snake&&this.getSnake().grow(e.growSnakeByLength)},pause:function(){var e=this;v.getWindow().clearInterval(e.getSnake().intervalId),v.getWindow().clearInterval(e.getSnakeBonusFood().intervalId),y.pauseButton.setAttribute("disabled","true"),y.playButton.hasAttribute("disabled")&&y.playButton.removeAttribute("disabled"),e.state=k.game.state.paused,v.LOGGER.log("game paused")},resume:function(){var e=this;e.getSnake().startSnake(),e.getSnakeBonusFood().startInterval(),y.playButton.setAttribute("disabled","true"),y.pauseButton.hasAttribute("disabled")&&y.pauseButton.removeAttribute("disabled"),e.state=k.game.state.playing,v.LOGGER.log("game resumed")},stop:function(){var e=this;e.state=k.game.state.stopped,[e.getSnake().intervalId,e.getSnakeBonusFood().intervalId,e.getSpeedBonusFood().intervalId].forEach(v.getWindow().clearInterval),[e.getSnake().intervalId,g].forEach(v.getWindow().clearTimeout),e.snake=null,e.snakeFood=null,e.snakeBonusFood=null,e.speedBonus=null,y.pauseButton.setAttribute("disabled",!0),y.playButton.setAttribute("disabled",!0),e.showModal({modalConfig:{texts:[T.GAME_OVER,"You Scored "+e.getScore()+" points"],btn1:{label:"quit",clickHandler:v.getWindow().close.bind(v.getWindow())},btn2:{label:"restart",clickHandler:v.getWindow().location.reload.bind(v.getWindow().location)}}})},manageInactivity:function(){var e=this;void 0!==g&&v.getWindow().clearTimeout(g),g=setTimeout((function(){e.showModal({pauseGame:!0,modalConfig:{texts:[T.INACTIVITY_TIMEOUT,T.Q_CONTINUE],btn1:{clickHandler:e.stop.bind(e)},btn2:{clickHandler:e.resume.bind(e)}}})}),1e3*Math.floor(k.game.inactivityTimeout))},handleSnakeDirectionChange:function(e){var t=this;-1!==k.supportedKeys.indexOf(e)&&t.getSnake().currentDirection!=e&&e!=k.keyConfig[String(t.getSnake().currentDirection)].reverse&&(t.snakeDirection=e,t.getSnake().currentDirection=t.snakeDirection,v.getDirectionCommands().add({id:Date.now(),direction:e,position:t.getSnake().head.getCenter()}),t.manageInactivity())},setButtonListeners:function(){v.getWindow().addEventListener("unload",this.stop),v.getDocument().addEventListener("keydown",(function(e){e.preventDefault(),-1!==k.supportedKeys.indexOf(e.keyCode)&&v.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:e.keyCode})}))},getScore:function(){return parseInt(y.scoreBoard.innerHTML)},updateScore:function(e){if("number"==typeof e){var t=parseInt(y.scoreBoard.innerHTML)+e;y.scoreBoard.innerHTML=t,t>0&&t%k.game.scoreCheckpointMultipleOf==0&&v.getGameEvents().emit("SCORE_CHECKPOINT",t/k.game.scoreCheckpointMultipleOf)}},increaseSnakeSpeed:function(){var e=this;v.getWindow().clearInterval(this.getSnake().intervalId),this.getSnake().startSnake(k.snake.turboSpeed),setTimeout((function(){v.getWindow().clearInterval(e.getSnake().intervalId),e.getSnake().startSnake(k.snake.speed)}),1e3*k.eatables.speedBonus.speedDuration)},processScoreCheckpoint:function(e){v.LOGGER.log("checkpoint ".concat(e," reached"))},showGameInfo:function(){this.showModal({pauseGame:!0,modalConfig:{elementIds:[k.game.legendContainerId],btn1:{show:!1},btn2:{label:"ok",clickHandler:this.resume.bind(this)}}})},showModal:function(e){var t=e.pauseGame,n=void 0!==t&&t,r=e.modalConfig;n&&this.pause(),o.show(r)},dropEatable:function(e){if(e){var t=[].concat(n(this.getSnake().bodyParts),n(this.getEatables())).reduce((function(e,t){return t&&t.x&&t.y&&t.x2&&t.y2?(e.push({x1:t.x,y1:t.y,x2:t.x2,y2:t.y2}),e):e}),[]);e.drop(t)}}}}}).PlaySnake;s=C(),A.init(s),s.start()};window.onload=function(){o()}})();