!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r=function(){var e,t={PAUSE_BUTTON_CLICKED:[function(){e.pause()}],RESUME_BUTTON_CLICKED:[function(){e.resume()}],EATABLE_CONSUMED:[function(e){e.hide(),"number"==typeof e.points&&n("UPDATE_SCORE",e.points)}],UPDATE_SCORE:[function(t){e.updateScore(t)}],USE_SPEED_BONUS:[function(){e.increaseSnakeSpeed()}],DEVOURED_SELF:[function(){e.stop()}],SNAKE_DIRECTION_CHANGE:[function(t){var n=t.direction;e.handleSnakeDirectionChange(parseInt(n))}]};function n(e,n){t.hasOwnProperty(e)?t[e].forEach((function(e){return e(n)})):console.warn("Invalid event triggered : ".concat(e))}return{init:function(t){e=t},emit:n,listen:function(e,n){Array.isArray(t[e])?t[e].push(n):t[e]=[n]},destruct:function(){t={}}}},i=function(e,t){var n=e.SNAKE,r=n.color,i=n.width,o=n.step,a=n.id,s=e.SNAKE_BONUS_FOOD.size,u=t.getArenaConfig().directionMap;function c(n,r,s,u,c,d){var l="".concat(a,"-part").concat(c),h=u,f=t.createHTMLElement({elementNamespace:t.getSvgNamespace(),elementType:e.SNAKE.elemType,attributes:{id:l,tabIndex:c,x:r,y:s,rx:i,ry:i,fill:d,width:t.pixelify(i),height:t.pixelify(i)},parent:n}),g=null,p=null;return{id:l,element:f,color:d,get direction(){return h},set direction(e){h=e},get next(){return g},get prev(){return p},set next(e){g=e},set prev(e){p=e},isSnakeHead:function(){return l===a},get x(){return parseInt(f.getAttribute("x"))},set x(e){f.setAttribute("x",Math.floor(e))},get y(){return parseInt(f.getAttribute("y"))},set y(e){f.setAttribute("y",Math.floor(e))},get x2(){return this.x+(i-1)},get y2(){return this.y+(i-1)},isTail:function(){return l===t.getSnake().tail.id},nextXY:function(){var e={x:this.x,y:this.y};switch(this.direction){case 37:e.x-=o;break;case 38:e.y-=o;break;case 39:e.x+=o;break;case 40:e.y+=o}e=t.checkBoundaryPosition(this.direction,e),this.x=e.x,this.y=e.y;var n=t.getDirectionCommands();if(n.hasCommands()){var r=n.getNextTurn(l);r&&r.position.x==this.x&&r.position.y==this.y&&(this.direction=r.direction,t.getSnakeDirectionMap()[l]=r.id,this.isTail()&&n.remove())}}}}return{Snake:function(e,n,a,d,l){var h,f=1,g=r,p=d,y=c(e,n,a,p,f,g),v=y;return{get arena(){return e},set arena(t){e=t},get length(){return f},set length(e){return f=e},get head(){return y},set head(e){return y=e},get tail(){return v},set tail(e){return v=e},get intervalId(){return h},set intervalId(e){h=e},get currentDirection(){return p},set currentDirection(e){p=e},get speed(){return l},set speed(e){l=e},get color(){return g},set color(e){g=e},UP:function(){this.move(0,-1*o)},DOWN:function(){this.move(0,o)},RIGHT:function(){this.move(o,0)},LEFT:function(){this.move(-1*o,0)},startSnake:function(e){var t=this;return e="number"==typeof e?e:this.speed,t.intervalId=setInterval((function(){t.changeDirection(t.currentDirection),t.start()}),e),t.intervalId},changeDirection:function(e){"number"==typeof e||this.currentDirection,this.head.direction=e},start:function(){this[u[this.head.direction]]()},getPositionOfNewPart:function(){var e=this.tail,t=e.x,n=e.y,r=e.direction,o=[Number(t),Number(n)],a=o[0],s=o[1];switch(r){case 37:a=t+i;break;case 38:s=n+i;break;case 39:a=t-i;break;case 40:s=n-i}return{x:a,y:s}},grow:function(e){var n=this.getPositionOfNewPart(),r=n.x,i=n.y,o=c(this.arena,r,i,this.tail.direction,this.length+1,this.tail.color);this.length+=1,this.tail.next=o,o.prev=this.tail,this.tail=o,t.getPositionUpdater().addObserver(this.tail),"function"==typeof e&&e()},changeColor:function(e){for(var t=this.head;null!==t.next;)n(t,e),t=t.next;function n(e,t){setTimeout((function(){e.color=t}),0)}},isEatingFood:function(){var e=t.getSnakeFood(),n=e.x,r=e.y;return this.head.x<n&&n<this.head.x2&&this.head.y<r&&r<this.head.y2},isEatingBonusFood:function(){var e=this.head,n=t.getSnakeBonusFood(),r=n.x,i=n.y,o=r+s-1,a=i-s-1,u=i+s-1;return r-s-1<e.x&&e.x<o&&a<e.y&&e.y<u},isEatingSpeedBonus:function(){var e=t.getSpeedBonus(),n=e.x,r=e.y;return this.head.x<n&&n<this.head.x2&&this.head.y<r&&r<this.head.y2},move:function(e,n){if(this.isDevouringSelf())t.getGameEvents().emit("DEVOURED_SELF");else{var r=this.head,i=t.checkBoundaryPosition(r.direction,{x:r.x+e,y:r.y+n}),o=i.x,a=i.y;r.x=o,r.y=a;var s=this.isEatingFood(),u=this.isEatingBonusFood(),c=this.isEatingSpeedBonus();s&&t.getGameEvents().emit("EATABLE_CONSUMED",t.getSnakeFood()),c&&(t.getGameEvents().emit("EATABLE_CONSUMED",t.getSpeedBonus()),t.getGameEvents().emit("USE_SPEED_BONUS",t.getSpeedBonus())),u&&t.getGameEvents().emit("EATABLE_CONSUMED",t.getSnakeBonusFood()),this.moveAllParts(s)}},moveAllParts:function(e){1===this.length&&t.getDirectionCommands().clear(),t.getPositionUpdater().notify(e)},isDevouringSelf:function(){for(var e=!1,t=this.head.next,n=this.head.direction;null!==t;){if(t.direction!==n||t.id===this.tail.id){switch(n){case 37:this.head.y===t.y&&this.head.x>t.x&&this.head.x<=t.x2&&(e=!0);break;case 38:this.head.x===t.x&&this.head.y>t.y&&this.head.y<=t.y2&&(e=!0);break;case 39:this.head.y===t.y&&this.head.x2<t.x2&&this.head.x2>=t.x&&(e=!0);break;case 40:this.head.x===t.x&&this.head.y2<t.y2&&this.head.y2>=t.y&&(e=!0)}if(e)break}t=t.next}return e}}}}},o=function(e){var t,n,r,i={display:"flex","flex-direction":"column"},o={display:"flex","flex-direction":"row"},a={"text-transform":"capitalize"},s=Object.keys(e.getArenaConfig().directionMap).reduce((function(t,n){return t[e.getArenaConfig().directionMap[n]]=n,t}),{UP:null,DOWN:null,RIGHT:null,LEFT:null});e.getDocumentBody().style.fontFamily="Candara";try{var u=e.createHTMLElement({elementType:"div",attributes:{style:e.getStyleString(Object.assign({},o,{"flex-wrap":"wrap","justify-content":"flex-start",width:e.pixelify(e.getArenaConfig().width),padding:"1% 0%"}))}}),c=e.getStyleString({padding:"2% 2%","border-radius":"5px",flex:"0 1 20%","text-align":"center","align-self":"flex-end"}),d=((r=e.createHTMLElement({elementType:"button",parent:u,innerHTML:e.getArenaConfig().pauseButton.text,attributes:{id:e.getArenaConfig().pauseButton.id,style:"".concat(c," order: ").concat(e.getArenaConfig().pauseButton.order)}})).addEventListener("click",(function(){e.getGameEvents().emit("PAUSE_BUTTON_CLICKED")})),r),l=function(){var t=e.createHTMLElement({elementType:"button",parent:u,innerHTML:e.getArenaConfig().resumeButton.text,attributes:{id:e.getArenaConfig().resumeButton.id,style:"".concat(c," margin-left: 2%; order: ").concat(e.getArenaConfig().resumeButton.order)},eventListeners:{click:e.getArenaConfig().resumeButton.clickHandler}});return t.addEventListener("click",(function(){e.getGameEvents().emit("RESUME_BUTTON_CLICKED")})),t}(),h=((n=e.createHTMLElement({elementType:"div",attributes:{id:"arena-container",style:e.getStyleString(Object.assign({},o,{"flex-wrap":"wrap"}))}})).addEventListener("touchstart",(function(e){if(e.preventDefault(),!(e.touches&&e.touches.length>1)){var n={};e.targetTouches&&(n.x=e.targetTouches[0].clientX,n.y=e.targetTouches[0].clientY),t=n}}),!0),n.addEventListener("touchmove",(function(e){e.preventDefault()}),!0),n.addEventListener("touchend",(function(n){n.preventDefault();var r=[parseInt(t.x),parseInt(t.y)],i=r[0],o=r[1];t=null;var a=n.changedTouches[0],u=[parseInt(a.clientX),parseInt(a.clientY)],c=u[0],d=u[1];if(i!==c||o!==d){var l=c-i,h=d-o;if(Math.abs(l)!==Math.abs(h))return 0===l?h>0?void e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.DOWN}):void e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.UP}):0===h?l>0?void e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.RIGHT}):void e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.LEFT}):void(l>0&&Math.abs(l)>Math.abs(h)?e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.RIGHT}):l<0&&Math.abs(l)>Math.abs(h)?e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.LEFT}):h>0&&Math.abs(h)>Math.abs(l)?e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.DOWN}):h<0&&Math.abs(h)>Math.abs(l)&&e.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:s.UP}))}}),!0),n.addEventListener("touchcancel",(function(e){e.preventDefault(),t=null}),!0),n),f=e.createHTMLElement({elementNamespace:e.getSvgNamespace(),elementType:"svg",attributes:{id:e.getArenaConfig().id,height:e.getArenaConfig().height,width:e.getArenaConfig().width,style:"border: ".concat(e.pixelify(e.getArenaConfig().borderWidth)," solid ").concat(e.getArenaConfig().borderColor)},parent:h});!function(){var t=e.createHTMLElement({elementType:"div",parent:h,attributes:{id:"legend-container",style:e.getStyleString(Object.assign({},i,{padding:"2px 2px","justify-content":"flex-start"}))}});try{var n=e.getArenaConfig().eatables,r=void 0===n?{}:n;Object.keys(r).forEach((function(n){var i=r[n],s=i.description,u=i.showInLegend,c=i.color,d=void 0===c?"white":c;if(u&&s){var l=e.createHTMLElement({parent:t,elementType:"div",attributes:{style:e.getStyleString(Object.assign({},o,{"margin-bottom":"5px","align-items":"center"}))}});e.createHTMLElement({parent:l,elementType:"div",attributes:{style:e.getStyleString({height:"10px",width:"10px","background-color":d,"border-radius":"5px"})}}),e.createHTMLElement({parent:l,elementType:"span",innerHTML:s,attributes:{style:e.getStyleString(Object.assign({},a,{padding:"0px 2px"}))}})}}))}catch(t){e.LOGGER.warn("Failed while drawing legend: ".concat(t))}}();var g=e.createHTMLElement({elementType:"div",innerHTML:"Your Score: "});return{SNAKE_ARENA:f,PLAY_BUTTON:l,PAUSE_BUTTON:d,SCORE_BOARD:e.createHTMLElement({elementType:"span",parent:g,attributes:{id:"score",style:e.getStyleString({"font-weight":"bold"})},innerHTML:"0"})}}catch(t){throw e.LOGGER.error("Failed to setup the page: ".concat(t)),t}},a=function(e,t){var n=e.SNAKE.width;function r(e,r){var i,o;do{var a=[Math.floor(Math.random()*(e.x-r))+t.getArenaConfig().borderWidth+1,Math.floor(Math.random()*(e.y-r))+t.getArenaConfig().borderWidth+1];i=a[0],o=a[1]}while(i%n!=0&&o%n!=0);return{x:i+2,y:o+2}}return{getNextEatablePosition:r,createEatableItem:function(n,i,o,a){if(!e[a])return t.LOGGER.warn("item ".concat(a," is not configured"));var s,u=e[a],c=u.id,d=u.limits,l=u.elemType,h=u.color,f=u.size,g=u.isIntervalBased,p=u.startAfter,y=u.points,v=u.appearDuration,m=t.createHTMLElement({elementType:l,elementNamespace:t.getSvgNamespace(),attributes:{id:c,cx:i,cy:o,r:f,fill:h},parent:t.getArena(),beforeElement:t.getSnake().head.element}),S=i+(f-1),b=o+(f-1);return{get isIntervalBased(){return g},get element(){return m},get arena(){return n},get limits(){return d},get intervalId(){return s},set intervalId(e){s=e},get startAfter(){return p},get size(){return f},get x2(){return S},set x2(e){S=e},get y2(){return b},set y2(e){b=e},get points(){return parseInt(y)},get x(){return parseInt(this.element.getAttribute("cx"))},set x(e){this.element.setAttribute("cx",Math.floor(e))},get y(){return parseInt(this.element.getAttribute("cy"))},set y(e){this.element.setAttribute("cy",Math.floor(e))},get appearDuration(){return v},startInterval:function(){if(this.isIntervalBased)return this.intervalId=setInterval(this.drop.bind(this),1e3*this.startAfter),this.intervalId},drop:function(){var e=r(this.limits,this.size),t=e.x,n=e.y;this.x=t,this.y=n,"number"==typeof this.appearDuration&&setTimeout(this.hide.bind(this),1e3*this.appearDuration)},hide:function(){this.x=-10,this.y=-10}}}}};function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(window){var n={DEFAULT:"Sorry.",START_GAME:"Sorry. Unable To Start The Game"},d=[parseInt(String(e).trim()),parseInt(String(t).trim())];e=d[0],t=d[1];var h,p=r(),v={id:"play-snake-arena",width:e,height:t,borderColor:"black",borderWidth:1,limits:{x:e-1,y:t-1},supportedKeys:[37,38,39,40],directionMap:{37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},keyConfig:{37:{reverse:39},38:{reverse:40},39:{reverse:37},40:{reverse:38}},pauseButton:{id:"pause-play-snake",text:"Pause",order:"0"},resumeButton:{id:"resume-play-snake",text:"Resume",order:"1"},eatables:{basicFood:{color:"#aba99f",description:"Basic food",showInLegend:!0,points:5,appearDuration:null,startAfter:0},bonusFood:{color:"#d12308",description:"Bonus point",showInLegend:!0,points:10,appearDuration:10,startAfter:30},speedBonus:{color:"#ffe205",description:"Extra speed",showInLegend:!0,points:0,appearDuration:10,startAfter:30}}},m=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];g(this,e),this.observers=n,this.topic=t}return y(e,[{key:"addObserver",value:function(e){e&&e.element&&e.element.id&&this.observers.push(e)}},{key:"removeObserver",value:function(e){this.observers.splice(this.observers.findIndex((function(t){return t.element.id===e.element.id})),1)}},{key:"notify",value:function(){var e=this;this.observers.forEach((function(t){t[e.topic]()}))}}]),e}(),S=function(e){c(n,e);var t=l(n);function n(){return g(this,n),t.call(this,"nextXY")}return y(n,[{key:"notify",value:function(e){if(u(f(n.prototype),"notify",this).call(this),e){var t=k.getSnakeFood();k.getSnake().grow(t.drop.bind(t))}}}]),n}(m),b=new S,E={},k={RENDER_UNIT:"px",getSvgNamespace:function(){return"http://www.w3.org/2000/svg"},getWindow:function(){return window},getDocument:function(){return this.getWindow().document},getDocumentBody:function(){return this.getDocument().body},showAlert:function(e){this.getWindow().alert(e)},getArena:function(){return x},getArenaConfig:function(){return v},getGame:function(){return h},getSnake:function(){return this.getGame().getSnake()},getSnakeFood:function(){return this.getGame().getSnakeFood()},getSnakeBonusFood:function(){return this.getGame().getSnakeBonusFood()},getSpeedBonus:function(){return this.getGame().getSpeedBonusFood()},getDirectionCommands:function(){return C},getSnakeDirectionMap:function(){return E},pixelify:function(e){return String(e).trim().concat(this.RENDER_UNIT)},getPositionUpdater:function(){return b},getStyleString:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).reduce((function(t,n){if(!n||!String(n).trim().length)return t;n=String(n).trim();var r=e[n];return String(r).trim().length?(r=String(r).trim(),t.concat(" ".concat(n,": ").concat(r,";"))):t}),"")},createHTMLElement:function(e){var t=e.elementType,n=e.innerHTML,r=e.attributes,i=void 0===r?{}:r,o=e.eventListeners,a=void 0===o?{}:o,u=e.elementNamespace,c=e.parent,d=e.beforeElement;c||(c=k.getDocumentBody());var l=u?this.getDocument().createElementNS(u,t):this.getDocument().createElement(t);return"object"===s(i)&&Object.keys(i).forEach((function(e){return l.setAttribute(e,i[e])})),n&&(l.innerHTML=String(n)),d?c.insertBefore(l,d):c.appendChild(l),"object"===s(a)&&Object.keys(a).forEach((function(e){return l.addEventListener(e,a[e])})),l},getGameEvents:function(){return p},checkBoundaryPosition:function(e,t){var n=this.getArenaConfig(),r=n.borderWidth,i=n.limits,o=B.SNAKE.width;switch(e){case 37:t.x<r&&(t.x=i.x-o);break;case 38:t.y<r&&(t.y=i.y-o);break;case 39:t.x+o>i.x&&(t.x=r);break;case 40:t.y+o>i.y&&(t.y=r)}return t},LOGGER:{log:console.log,error:console.error,warn:console.warn}},A=o(k),x=A.SNAKE_ARENA,T=A.PLAY_BUTTON,O=A.PAUSE_BUTTON,D=A.SCORE_BOARD;if(!x)return k.showAlert("Sorry. Unable to start the game.");var _,I,N,B={SNAKE:{id:(_={snakeId:"the-snake",snakeFoodId:"the-snake-food",snakeSpeed:20,snakeColor:"black",snakeLength:1,snakeSize:15,basicFoodColor:v.eatables.basicFood.color,basicFoodStartAfter:2,foodPoints:v.eatables.basicFood.points,bonusFoodId:"the-snake-bonus-food",bonusFoodPoints:v.eatables.bonusFood.points,bonusFoodColor:v.eatables.bonusFood.color,bonusFoodAppearDuration:v.eatables.bonusFood.appearDuration,bonusFoodStartAfter:v.eatables.bonusFood.startAfter,speedBonusId:"the-speed-bonus",speedBonusColor:v.eatables.speedBonus.color,speedBonusPoints:v.eatables.speedBonus.points,speedBonusStartAfter:v.eatables.speedBonus.startAfter,speedBonusAppearDuration:v.eatables.speedBonus.appearDuration,speedBonusDuration:10}).snakeId,elemType:"rect",width:_.snakeSize,color:_.snakeColor,length:_.snakeLength,speed:_.snakeSpeed,step:1},SNAKE_PART:{idPrefix:_.snakeId+"-part"},SNAKE_FOOD:{id:_.snakeFoodId,elemType:"circle",color:_.basicFoodColor,size:Math.floor(_.snakeSize/3),startAfter:_.basicFoodStartAfter,limits:{x:k.getArenaConfig().limits.x-_.snakeSize,y:k.getArenaConfig().limits.y-_.snakeSize},points:_.foodPoints},SNAKE_BONUS_FOOD:{id:_.bonusFoodId,color:_.bonusFoodColor,elemType:"circle",size:_.snakeSize,startAfter:_.bonusFoodStartAfter,limits:{x:k.getArenaConfig().limits.x-2*_.snakeSize,y:k.getArenaConfig().limits.y-2*_.snakeSize},points:_.bonusFoodPoints,isIntervalBased:!0,appearDuration:_.bonusFoodAppearDuration},SPEED_BONUS_FOOD:{id:_.speedBonusId,elemType:"circle",color:_.speedBonusColor,size:Math.floor(_.snakeSize/3),points:_.speedBonusPoints,startAfter:_.speedBonusStartAfter,limits:{x:k.getArenaConfig().limits.x-_.snakeSize,y:k.getArenaConfig().limits.y-_.snakeSize},isIntervalBased:!0,speedDuration:_.speedBonusDuration,appearDuration:_.speedBonusAppearDuration},ARENA:{center:{x:Math.floor(Math.floor(x.getAttribute("width"))/2),y:Math.floor(Math.floor(x.getAttribute("height"))/2)}}},C=(I={id:Date.now(),direction:v.supportedKeys[2],position:{x:B.ARENA.center.x,y:B.ARENA.center.y}},N=[],I&&N.push(I),{add:function(e){var t=N[N.length-1];t&&t.position.x==e.position.x&&t.position.y==e.position.y?t.direction=e.direction:N.push(e)},getFirst:function(){return N[0]},remove:function(){N.shift()},clear:function(){N.splice(0,N.length)},hasCommands:function(){return N.length>0},getNextTurn:function(e){var t=k.getSnakeDirectionMap();if(void 0===t[e])return this.getFirst();var n=N.findIndex((function(n){return n.id===t[e]}));return n==N.length-1?void 0:N[n+1]}}),F=a(B,k),w=F.createEatableItem,M=F.getNextEatablePosition,L=i(B,k),P=L.Snake,R=function(){function e(t){g(this,e),this.intervals=[],this.timers=[],this._snake,this._snakeFood,this._snakeBonusFood,this.snakeDirection,this.arena=t,this.snakeSpeed=20,this._speedBonus}return y(e,[{key:"getSnake",value:function(){if(this._snake)return this._snake;var e=C.getFirst(),t=e.direction,n=e.position,r=n.x,i=n.y;return this.snakeDirection=t,this._snake=P(this.arena,r,i,this.snakeDirection,this.snakeSpeed),this._snake}},{key:"getSpeedBonusFood",value:function(){return this._speedBonus||(this._speedBonus=w(this.arena,-10,-10,"SPEED_BONUS_FOOD")),this._speedBonus}},{key:"getSnakeFood",value:function(){if(this._snakeFood)return this._snakeFood;var e=M(B.SNAKE_FOOD.limits,B.SNAKE_FOOD.size),t=e.x,n=e.y;return this._snakeFood=w(this.arena,t,n,"SNAKE_FOOD"),this._snakeFood}},{key:"getSnakeBonusFood",value:function(){return this._snakeBonusFood||(this._snakeBonusFood=w(this.arena,-10,-10,"SNAKE_BONUS_FOOD")),this._snakeBonusFood}},{key:"start",value:function(){try{this.getSnake();var e=this.getSnakeFood();setTimeout(1e3*B.SNAKE_FOOD.startAfter,e);var t=this.getSnakeBonusFood();this.intervals.push(t.startInterval());var r=this.getSpeedBonusFood();this.intervals.push(r.startInterval()),this.setButtonListeners(),this.intervals.push(this.getSnake().startSnake())}catch(e){k.showAlert(n.START_GAME)}}},{key:"pause",value:function(){k.getWindow().clearInterval(this.getSnake().intervalId),k.getWindow().clearInterval(this.getSnakeBonusFood().intervalId),O.setAttribute("disabled","true"),T.hasAttribute("disabled")&&T.removeAttribute("disabled"),k.LOGGER.log("game paused")}},{key:"resume",value:function(){this.getSnake().startSnake(),this.getSnakeBonusFood().startInterval(),T.setAttribute("disabled","true"),O.hasAttribute("disabled")&&O.removeAttribute("disabled"),k.LOGGER.log("game resumed")}},{key:"stop",value:function(){k.getWindow().clearInterval(this.getSnake().intervalId),k.getWindow().clearInterval(this.getSnakeBonusFood().intervalId),k.getWindow().clearInterval(this.getSpeedBonusFood().intervalId),this._snake=null,this._snakeFood=null,this._snakeBonusFood=null,this._speedBonus=null,this._speedBonus=null,k.getWindow().alert("GAME OVER\nYou Scored "+this.getScore()+" points.")}},{key:"handleSnakeDirectionChange",value:function(e){-1!==k.getArenaConfig().supportedKeys.indexOf(e)&&this.getSnake().currentDirection!=e&&e!=k.getArenaConfig().keyConfig[String(this.getSnake().currentDirection)].reverse&&(this.snakeDirection=e,this.getSnake().currentDirection=this.snakeDirection,C.add({id:Date.now(),direction:e,position:{x:this.getSnake().head.x,y:this.getSnake().head.y}}))}},{key:"setButtonListeners",value:function(){k.getWindow().addEventListener("unload",this.stop),k.getDocument().addEventListener("keydown",(function(e){-1!==k.getArenaConfig().supportedKeys.indexOf(e.keyCode)&&k.getGameEvents().emit("SNAKE_DIRECTION_CHANGE",{direction:e.keyCode})}))}},{key:"getScore",value:function(){return parseInt(D.innerHTML)}},{key:"updateScore",value:function(e){return D.innerHTML=+D.innerHTML+e,parseInt(D.innerHTML)}},{key:"increaseSnakeSpeed",value:function(){var e=this;k.getWindow().clearInterval(this.getSnake().intervalId),this.intervals.push(this.getSnake().startSnake(this.getSnake().speed/4)),setTimeout((function(){k.getWindow().clearInterval(e.getSnake().intervalId),e.intervals.push(e.getSnake().startSnake())}),1e3*B.SPEED_BONUS_FOOD.speedDuration)}}]),e}();h=new R(x),p.init(h),h.start()}}()}]);