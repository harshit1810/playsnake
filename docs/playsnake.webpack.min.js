!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){((t={arenaHeight:500,arenaWidth:500})=>{if(!window)return;const e={default:"Sorry.",startGame:"Sorry. Unable To Start The Game"},i=window,n=i.document,r=n.body;r.style.fontFamily="Candara";const[o,s]=["http://www.w3.org/2000/svg","px"],a=function(t){return String(t).trim().concat(this)}.bind(s),d={id:"play-snake-arena",width:t.arenaWidth,height:t.arenaHeight,borderColor:"black",borderWidth:1,limits:{x:t.arenaWidth-1,y:t.arenaHeight-1},supportedKeys:[37,38,39,40],keyConfig:{37:{reverse:39},38:{reverse:40},39:{reverse:37},40:{reverse:38}},pauseButton:{id:"pause-play-snake",text:"Pause",order:"0",clickHandler:function(t){_(),E(),A.log("game paused"),c.setAttribute("disabled","true"),h.hasAttribute("disabled")&&h.removeAttribute("disabled")}},resumeButton:{id:"resume-play-snake",text:"Resume",order:"1",clickHandler:function(t){w(p.SNAKE.speed),K(p.SNAKE_BONUS_FOOD.startAfter),A.log("game resumed"),h.setAttribute("disabled","true"),c.hasAttribute("disabled")&&c.removeAttribute("disabled")}}},l=function(){try{let t=n.createElement("div");t.setAttribute("style","display:flex ; flex-direction:row ; flex-wrap:nowrap; width:"+a(d.width)+"; padding:1% 0%;"),r.appendChild(t);let e="padding:2% 2%; border-radius:5px; flex:0 1 20%; text-align:center; align-self:flex-end;",i=n.createElement("button");i.setAttribute("id",d.pauseButton.id),i.setAttribute("style",e),i.style.order=d.pauseButton.order,i.innerHTML=d.pauseButton.text,t.appendChild(i),i.addEventListener("click",d.pauseButton.clickHandler);let s=n.createElement("button");s.setAttribute("style",e+" margin-left:2%;"),s.setAttribute("id",d.resumeButton.id),s.style.order=d.resumeButton.order,s.innerHTML=d.resumeButton.text,t.appendChild(s),s.addEventListener("click",d.resumeButton.clickHandler);let l=n.createElementNS(o,"svg");l.setAttribute("id",d.id),l.setAttribute("height",d.height),l.setAttribute("width",d.width),l.style.border=a(d.borderWidth)+" solid "+d.borderColor,r.appendChild(l);let u=n.createElement("div");return u.innerHTML='Your Score: <span id="score" style="font-weight: bold;">0</span>',r.appendChild(u),l}catch(t){return!1}}();if(!l)return O("Sorry. Unable to start the game.");let u=r.querySelector("#score"),c=r.querySelector("#"+d.pauseButton.id),h=r.querySelector("#"+d.resumeButton.id);class f{constructor(t,e=[]){this.observers=e,this.topic=t}addObserver(t){t.element&&void 0!==t.element.id&&this.observers.push(t)}removeObserver(t){this.observers.splice(this.observers.findIndex(e=>e.element.id===t.element.id),1)}notify(){this.observers.forEach(t=>{t[this.topic]()})}}const y=new class extends f{constructor(){super("nextXY")}notify(t){super.notify(),t&&1==t&&P.grow(M.drop)}},A={log:console.log,error:console.error};let x,S;const p=function(t){return{SNAKE:{id:t.snakeId,elemType:"rect",width:t.snakeSize,color:t.primaryColor,length:t.snakeLength,speed:t.snakeSpeed,directionMap:{37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},step:1},SNAKE_PART:{idPrefix:t.snakeId+"-part"},SNAKE_FOOD:{id:t.snakeFoodId,elemType:"circle",color:t.secondaryColor,size:Math.floor(t.snakeSize/3),startAfter:2,limits:{x:d.limits.x-t.snakeSize,y:d.limits.y-t.snakeSize},points:t.foodPoints},SNAKE_BONUS_FOOD:{id:t.snakeBonusFoodId,color:t.alertColor,elemType:"circle",size:t.snakeSize,startAfter:30,limits:{x:d.limits.x-2*t.snakeSize,y:d.limits.y-2*t.snakeSize},points:t.bonusFoodPoints,duration:10},ARENA:{center:{x:Math.floor(Math.floor(l.getAttribute("width"))/2),y:Math.floor(Math.floor(l.getAttribute("height"))/2)}}}}({snakeId:"the-snake",snakeFoodId:"the-snake-food",snakeBonusFoodId:"the-snake-bonus-food",snakeSpeed:20,primaryColor:"black",secondaryColor:"grey",alertColor:"red",snakeLength:1,snakeSize:15,foodPoints:5,bonusFoodPoints:10});let b=39;const m=function(t){let e=[];return t&&e.push(t),{add:function(t){let i=e[e.length-1];i&&i.position.x==t.position.x&&i.position.y==t.position.y?i.direction=t.direction:e.push(t)},getFirst:function(){return e[0]},remove:function(){e.shift()},clear:function(){e.splice(0,e.length)},hasCommands:function(){return e.length>0},getNextTurn:function(t){if(void 0===N[t])return this.getFirst();let i=e.findIndex(e=>e.id===N[t]);return i==e.length-1?void 0:e[i+1]}}}({id:Date.now(),direction:b,position:{x:p.ARENA.center.x,y:p.ARENA.center.y}}),N={};function O(t){i.alert(t)}function g(){P=null,_(),M=null,I=null,E()}function E(){i.clearInterval(S)}function K(t){S=setInterval(I.drop,1e3*t)}function w(t){x=setInterval(function(){let t=b;P.changeDirection(t),P.start()},t)}function _(){i.clearInterval(x)}function k(t){u.innerHTML=+u.innerHTML+t}class v{constructor(t,e,i,n,r=p.SNAKE.color){this.head=new F(t,e,i,n,r),this.tail=this.head,this.arena=t,this.UP=function(){this.move(0,-1*p.SNAKE.step)},this.DOWN=function(){this.move(0,p.SNAKE.step)},this.RIGHT=function(){this.move(p.SNAKE.step,0)},this.LEFT=function(){this.move(-1*p.SNAKE.step,0)},this.turningPoints=[],this.length=1}changeDirection(t){this.head.direction=t}grow(t){let{x:e,y:i}=this.tail.getXYOfNextPart(),n=new F(P.arena,e,i,this.tail.direction,this.tail.color);this.tail.next=n,n.prev=this.tail,this.tail=n,this.length+=1,y.addObserver(this.tail),k(p.SNAKE_FOOD.points),"function"==typeof t&&t()}changeColor(t){let e=this.head;for(;null!==e.next;)i(e,t),e=e.next;function i(t,e){setTimeout(()=>{t.color=e},0)}}start(){this[p.SNAKE.directionMap[String(this.head.direction)]]()}isEatingFood(){let t=this.head;return t.x<M.x&&M.x<t.x2&&t.y<M.y&&M.y<t.y2&&(M.hide(),!0)}isEatingBonusFood(){let t=this.head,e=I.x-p.SNAKE_BONUS_FOOD.size-1,i=I.x+p.SNAKE_BONUS_FOOD.size-1,n=I.y-p.SNAKE_BONUS_FOOD.size-1,r=I.y+p.SNAKE_BONUS_FOOD.size-1;return e<t.x&&t.x<i&&n<t.y&&t.y<r}move(t,e){let n=this.head,[r,o]=[n.x,n.y],{x:s,y:a}=F.checkBoundaryPosition(n.direction,{x:r+t,y:o+e});if(this.isEatingItself())return i.alert("GAME OVER\nYou Scored "+u.innerHTML+" points."),void g();n.x=s,n.y=a;let d=this.isEatingFood();this.isEatingBonusFood()&&(I.hide(),k(p.SNAKE_BONUS_FOOD.points)),this.moveAllParts(d)}moveAllParts(t){1===this.length&&m.clear(),y.notify(t)}isEatingItself(){let t=!1,e=P.head.next,i=P.head.direction;for(;null!==e;){if(e.direction!==i||e.id===P.tail.id){switch(i){case 37:P.head.y===e.y&&P.head.x>e.x&&P.head.x<=e.x2&&(t=!0);break;case 38:P.head.x===e.x&&P.head.y>e.y&&P.head.y<=e.y2&&(t=!0);break;case 39:P.head.y===e.y&&P.head.x2<e.x2&&P.head.x2>=e.x&&(t=!0);break;case 40:P.head.x===e.x&&P.head.y2<e.y2&&P.head.y2>=e.y&&(t=!0)}if(t)break}e=e.next}return!!t}}class F{constructor(t,e,i,r,s){let d=P.length;this.id=void 0!==d?p.SNAKE.id+"-part"+(P.length+1):p.SNAKE.id,this.direction=r,this.element=(()=>{let r=n.createElementNS(o,p.SNAKE.elemType);return r.setAttribute("id",this.id),r.setAttribute("tabIndex",d),r.setAttribute("x",e),r.setAttribute("y",i),r.setAttribute("rx",p.SNAKE.width),r.setAttribute("ry",p.SNAKE.width),r.setAttribute("fill",s),r.setAttribute("width",a(p.SNAKE.width)),r.setAttribute("height",a(p.SNAKE.width)),t.appendChild(r),r})(),this.color=s,this.next=null,this.prev=null}isSnakeHead(){return this.id===p.SNAKE.id}get x(){return parseInt(this.element.getAttribute("x"))}set x(t){this.element.setAttribute("x",Math.floor(t))}get y(){return parseInt(this.element.getAttribute("y"))}set y(t){this.element.setAttribute("y",Math.floor(t))}get x2(){return this.x+(p.SNAKE.width-1)}get y2(){return this.y+(p.SNAKE.width-1)}isTail(){return this.id===P.tail.id}nextXY(){let t={x:this.x,y:this.y};switch(this.direction){case 37:t.x-=p.SNAKE.step;break;case 38:t.y-=p.SNAKE.step;break;case 39:t.x+=p.SNAKE.step;break;case 40:t.y+=p.SNAKE.step}if(t=F.checkBoundaryPosition(this.direction,t),this.x=t.x,this.y=t.y,m.hasCommands()){let t=m.getNextTurn(this.id);t&&t.position.x==this.x&&t.position.y==this.y&&(this.direction=t.direction,N[this.id]=t.id,this.isTail()&&m.remove())}}getXYOfNextPart(){let[t,e]=[this.x,this.y];switch(this.direction){case 37:t+=p.SNAKE.width;break;case 38:e+=p.SNAKE.width;break;case 39:t-=p.SNAKE.width;break;case 40:e-=p.SNAKE.width}return{x:t,y:e}}static checkBoundaryPosition(t,e){switch(t){case 37:e.x<d.borderWidth&&(e.x=d.limits.x-p.SNAKE.width);break;case 38:e.y<d.borderWidth&&(e.y=d.limits.y-p.SNAKE.width);break;case 39:e.x+p.SNAKE.width>d.limits.x&&(e.x=d.borderWidth);break;case 40:e.y+p.SNAKE.width>d.limits.y&&(e.y=d.borderWidth)}return e}}class B{constructor(t,e,i,r=p.SNAKE_FOOD.color,s=p.SNAKE_FOOD.size){M instanceof B||(this.element=(()=>{let t=n.createElementNS(o,p.SNAKE_FOOD.elemType);return t.setAttribute("id",p.SNAKE_FOOD.id),t.setAttribute("cx",e),t.setAttribute("cy",i),t.setAttribute("r",s),t.setAttribute("fill",r),l.insertBefore(t,P.head.element),t})(),this.arena=t,[this.x2,this.y2]=[e+(p.SNAKE_FOOD.size-1),i+(p.SNAKE_FOOD.size-1)])}get x(){return parseInt(this.element.getAttribute("cx"))}set x(t){this.element.setAttribute("cx",Math.floor(t))}get y(){return parseInt(this.element.getAttribute("cy"))}set y(t){this.element.setAttribute("cy",Math.floor(t))}static getNextFoodPosition(){function t(){return Math.floor(Math.random()*(p.SNAKE_FOOD.limits.x-p.SNAKE_FOOD.size))+d.borderWidth+1}function e(){return Math.floor(Math.random()*(p.SNAKE_FOOD.limits.y-p.SNAKE_FOOD.size))+d.borderWidth+1}return new Promise(function(n,r){let o,[s,a]=[t(),e()];o=setInterval(function(n,d,l){try{s%n==0&&a%n==0?(i.clearInterval(o),d({x:s+2,y:a+2})):[s,a]=[t(),e()]}catch(t){r(t)}},0,p.SNAKE.width,n,r)})}drop(){M instanceof B&&B.getNextFoodPosition().then(t=>{M.x=t.x,M.y=t.y})}hide(){this.x=-10,this.y=-10}}class D{constructor(t,e,i,r=p.SNAKE_BONUS_FOOD.color,s=p.SNAKE_BONUS_FOOD.size){I instanceof D||(this.element=(()=>{let t=n.createElementNS(o,p.SNAKE_BONUS_FOOD.elemType);return t.setAttribute("id",p.SNAKE_BONUS_FOOD.id),t.setAttribute("cx",e),t.setAttribute("cy",i),t.setAttribute("r",s),t.setAttribute("fill",r),l.insertBefore(t,P.head.element),t})(),this.arena=t,[this.x2,this.y2]=[e+(p.SNAKE_BONUS_FOOD.size-1),i+(p.SNAKE_BONUS_FOOD.size-1)])}get x(){return parseInt(this.element.getAttribute("cx"))}set x(t){this.element.setAttribute("cx",Math.floor(t))}get y(){return parseInt(this.element.getAttribute("cy"))}set y(t){this.element.setAttribute("cy",Math.floor(t))}static getNextFoodPosition(){function t(){return Math.floor(Math.random()*(p.SNAKE_BONUS_FOOD.limits.x-p.SNAKE_BONUS_FOOD.size))+d.borderWidth+1}function e(){return Math.floor(Math.random()*(p.SNAKE_BONUS_FOOD.limits.y-p.SNAKE_BONUS_FOOD.size))+d.borderWidth+1}return new Promise(function(n,r){let o,[s,a]=[t(),e()];o=setInterval(function(n,d,l){try{s%n==0&&a%n==0?(i.clearInterval(o),d({x:s+2,y:a+2})):[s,a]=[t(),e()]}catch(t){r(t)}},0,p.SNAKE.width,n,r)})}drop(){I instanceof D&&D.getNextFoodPosition().then(function(t){I.x=t.x,I.y=t.y,setTimeout(I.hide,1e3*p.SNAKE_BONUS_FOOD.duration)})}hide(){I.x=-100,I.y=-100}}let P=function(){let t;return{get:()=>new Promise(function(e,i){try{if(t instanceof v)return e(t);t=function(){let t=m.getFirst();return new v(l,t.position.x,t.position.y,t.direction,p.SNAKE.color)}(),A.log("snake created"),e(t)}catch(t){i(t)}})}}(),M=function(){let t;return{get:()=>new Promise(function(e,i){try{if(t instanceof B)return e(t);new Promise(function(t,e){B.getNextFoodPosition().then(function(e){t(new B(P.arena,e.x,e.y,p.SNAKE_FOOD.color,p.SNAKE_FOOD.size))},function(t){e(t)})}).then(function(i){t=i,setTimeout(e,1e3*p.SNAKE_FOOD.startAfter,t),e(t)},function(t){A.error(t)})}catch(t){i(t)}})}}(),I=function(){let t;return{get:()=>new Promise(function(e,i){try{if(t instanceof D)return e(t);new Promise(function(t,e){D.getNextFoodPosition().then(function(e){t(new D(P.arena,e.x,e.y))},function(t){})}).then(function(i){e(t=i)})}catch(t){i(t)}})}}();P.get().then(function(t){return P=t,M.get()},t=>Promise.reject(t)).then(function(t){return M=t,I.get().then(function(t){I=t,K(p.SNAKE_BONUS_FOOD.startAfter)},function(t){}),new Promise(function(t,e){try{i.addEventListener("unload",()=>{g()}),n.addEventListener("keydown",function(t){-1!==d.supportedKeys.indexOf(t.keyCode)&&b!=t.keyCode&&t.keyCode!=d.keyConfig[String(b)].reverse&&(b=t.keyCode,m.add({id:Date.now(),direction:t.keyCode,position:{x:P.head.x,y:P.head.y}}))}),t(!0)}catch(t){e(t)}})},t=>Promise.reject(t)).then(function(t){w(p.SNAKE.speed)},function(t){g(),O(e.startGame)})})()}]);