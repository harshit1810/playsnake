!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){((t={arenaHeight:500,arenaWidth:500})=>{if(!window)return;const e={default:"Sorry.",startGame:"Sorry. Unable To Start The Game"},i=window,r=i.document,n=r.body;n.style.fontFamily="Candara";const[o,s]=["http://www.w3.org/2000/svg","px"],a=function(t){return String(t).trim().concat(this)}.bind(s),d={id:"play-snake-arena",width:t.arenaWidth,height:t.arenaHeight,borderColor:"black",borderWidth:1,limits:{x:t.arenaWidth-1,y:t.arenaHeight-1},supportedKeys:[37,38,39,40],keyConfig:{37:{reverse:39},38:{reverse:40},39:{reverse:37},40:{reverse:38}},pauseButton:{id:"pause-play-snake",text:"Pause",order:"0",clickHandler:function(t){w(),p.log("game paused"),c.setAttribute("disabled","true"),h.hasAttribute("disabled")&&h.removeAttribute("disabled")}},resumeButton:{id:"resume-play-snake",text:"Resume",order:"1",clickHandler:function(t){N(b.SNAKE.speed),p.log("game resumed"),h.setAttribute("disabled","true"),c.hasAttribute("disabled")&&c.removeAttribute("disabled")}}},l=function(){try{let t=r.createElement("div");t.setAttribute("style","display:flex ; flex-direction:row ; flex-wrap:nowrap; width:"+a(d.width)+"; padding:1% 0%;"),n.appendChild(t);let e="padding:2% 2%; border-radius:5px; flex:0 1 20%; text-align:center; align-self:flex-end;",i=r.createElement("button");i.setAttribute("id",d.pauseButton.id),i.setAttribute("style",e),i.style.order=d.pauseButton.order,i.innerHTML=d.pauseButton.text,t.appendChild(i),i.addEventListener("click",d.pauseButton.clickHandler);let s=r.createElement("button");s.setAttribute("style",e+" margin-left:2%;"),s.setAttribute("id",d.resumeButton.id),s.style.order=d.resumeButton.order,s.innerHTML=d.resumeButton.text,t.appendChild(s),s.addEventListener("click",d.resumeButton.clickHandler);let l=r.createElementNS(o,"svg");l.setAttribute("id",d.id),l.setAttribute("height",d.height),l.setAttribute("width",d.width),l.style.border=a(d.borderWidth)+" solid "+d.borderColor,n.appendChild(l);let u=r.createElement("div");return u.innerHTML='Your Score: <span id="score" style="font-weight: bold;">0</span>',n.appendChild(u),l}catch(t){return!1}}();if(!l)return S("Sorry. Unable to start the game.");let u=n.querySelector("#score"),c=n.querySelector("#"+d.pauseButton.id),h=n.querySelector("#"+d.resumeButton.id);class y{constructor(t,e=[]){this.observers=e,this.topic=t}addObserver(t){t.element&&void 0!==t.element.id&&this.observers.push(t)}removeObserver(t){this.observers.splice(this.observers.findIndex(e=>e.element.id===t.element.id),1)}notify(){this.observers.forEach(t=>{t[this.topic]()})}}const f=new class extends y{constructor(){super("nextXY")}notify(t){super.notify(),t&&1==t&&O.grow(P.drop)}},p={log:console.log,error:console.error};let A;const b=function(t){return{SNAKE:{id:t.snakeId,elemType:"rect",width:t.snakeSize,color:t.primaryColor,length:t.snakeLength,speed:t.snakeSpeed,directionMap:{37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},step:1},SNAKE_PART:{idPrefix:t.snakeId+"-part"},SNAKE_FOOD:{id:t.snakeFoodId,elemType:"circle",color:t.secondaryColor,size:Math.floor(t.snakeSize/3),startAfter:2,limits:{x:d.limits.x-t.snakeSize,y:d.limits.y-t.snakeSize}},SNAKE_FOOD_BONUS:{color:t.alertColor,size:a(2*t.snakeSize)},ARENA:{center:{x:Math.floor(Math.floor(l.getAttribute("width"))/2),y:Math.floor(Math.floor(l.getAttribute("height"))/2)}}}}({snakeId:"the-snake",snakeFoodId:"the-snake-food",snakeSpeed:20,primaryColor:"black",secondaryColor:"grey",alertColor:"red",snakeLength:1,snakeSize:15});let x=39;const m=function(t){let e=[];return t&&e.push(t),{add:function(t){let i=e[e.length-1];i&&i.position.x==t.position.x&&i.position.y==t.position.y?i.direction=t.direction:e.push(t)},getFirst:function(){return e[0]},remove:function(){e.shift()},clear:function(){e.splice(0,e.length)},hasCommands:function(){return e.length>0},getNextTurn:function(t){if(void 0===g[t])return this.getFirst();let i=e.findIndex(e=>e.id===g[t]);return i==e.length-1?void 0:e[i+1]}}}({id:Date.now(),direction:x,position:{x:b.ARENA.center.x,y:b.ARENA.center.y}}),g={};function S(t){i.alert(t)}function E(){O=null,w(),P=null}function N(t){A=setInterval(()=>{let t=x;O.changeDirection(t),O.start()},t)}function w(){i.clearInterval(A)}class v{constructor(t,e,i,r,n=b.SNAKE.color){this.head=new k(t,e,i,r,n),this.tail=this.head,this.arena=t,this.UP=function(){this.move(0,-1*b.SNAKE.step)},this.DOWN=function(){this.move(0,b.SNAKE.step)},this.RIGHT=function(){this.move(b.SNAKE.step,0)},this.LEFT=function(){this.move(-1*b.SNAKE.step,0)},this.turningPoints=[],this.length=1}changeDirection(t){this.head.direction=t}grow(t){let{x:e,y:i}=this.tail.getXYOfNextPart(),r=new k(O.arena,e,i,this.tail.direction,this.tail.color);this.tail.next=r,r.prev=this.tail,this.tail=r,this.length+=1,f.addObserver(this.tail),u.innerHTML=+u.innerHTML+10,"function"==typeof t&&t()}changeColor(t){let e=this.head;for(;null!==e.next;)i(e,t),e=e.next;function i(t,e){setTimeout(()=>{t.color=e},0)}}start(){this[b.SNAKE.directionMap[String(this.head.direction)]]()}isEatingFood(){let t=this.head;return t.x<P.x&&P.x<t.x2&&t.y<P.y&&P.y<t.y2&&(P.hide(),!0)}move(t,e){let r=this.head,[n,o]=[r.x,r.y],{x:s,y:a}=k.checkBoundaryPosition(r.direction,{x:n+t,y:o+e});if(this.isEatingItself(s,a))return i.alert("GAME OVER\nYou Scored "+u.innerHTML+" points."),void E();r.x=s,r.y=a;let d=this.isEatingFood();this.moveAllParts(d)}moveAllParts(t){1===this.length&&m.clear(),f.notify(t)}isEatingItself(t,e){let i,r=function(r){return r.x===t&&r.y===e&&(i=r,!0)},n=O.head.next;for(;null!==n&&!r(n);)n=n.next;return void 0!==i}}class k{constructor(t,e,i,n,s){let d=O.length;this.id=void 0!==d?b.SNAKE.id+"-part"+(O.length+1):b.SNAKE.id,this.direction=n,this.element=(()=>{let n=r.createElementNS(o,b.SNAKE.elemType);return n.setAttribute("id",this.id),n.setAttribute("tabIndex",d),n.setAttribute("x",e),n.setAttribute("y",i),n.setAttribute("rx",b.SNAKE.width),n.setAttribute("ry",b.SNAKE.width),n.setAttribute("fill",s),n.setAttribute("width",a(b.SNAKE.width)),n.setAttribute("height",a(b.SNAKE.width)),t.appendChild(n),n})(),this.color=s,this.next=null,this.prev=null}isSnakeHead(){return this.id===b.SNAKE.id}get x(){return parseInt(this.element.getAttribute("x"))}set x(t){this.element.setAttribute("x",Math.floor(t))}get y(){return parseInt(this.element.getAttribute("y"))}set y(t){this.element.setAttribute("y",Math.floor(t))}get x2(){return this.x+(b.SNAKE.width-1)}get y2(){return this.y+(b.SNAKE.width-1)}isTail(){return this.id===O.tail.id}nextXY(){let t={x:this.x,y:this.y};switch(this.direction){case 37:t.x-=b.SNAKE.step;break;case 38:t.y-=b.SNAKE.step;break;case 39:t.x+=b.SNAKE.step;break;case 40:t.y+=b.SNAKE.step}if(t=k.checkBoundaryPosition(this.direction,t),this.x=t.x,this.y=t.y,m.hasCommands()){let t=m.getNextTurn(this.id);t&&t.position.x==this.x&&t.position.y==this.y&&(this.direction=t.direction,g[this.id]=t.id,this.isTail()&&m.remove())}}getXYOfNextPart(){let[t,e]=[this.x,this.y];switch(this.direction){case 37:t+=b.SNAKE.width;break;case 38:e+=b.SNAKE.width;break;case 39:t-=b.SNAKE.width;break;case 40:e-=b.SNAKE.width}return{x:t,y:e}}static checkBoundaryPosition(t,e){switch(t){case 37:e.x<d.borderWidth&&(e.x=d.limits.x-b.SNAKE.width);break;case 38:e.y<d.borderWidth&&(e.y=d.limits.y-b.SNAKE.width);break;case 39:e.x+b.SNAKE.width>d.limits.x&&(e.x=d.borderWidth);break;case 40:e.y+b.SNAKE.width>d.limits.y&&(e.y=d.borderWidth)}return e}}class K{constructor(t,e,i,n=b.SNAKE_FOOD.color,s=b.SNAKE_FOOD.size){P instanceof K||(this.element=(()=>{let t=r.createElementNS(o,b.SNAKE_FOOD.elemType);return t.setAttribute("cx",e),t.setAttribute("cy",i),t.setAttribute("r",s),t.setAttribute("fill",n),l.insertBefore(t,O.head.element),t})(),this.arena=t,[this.x2,this.y2]=[e+(b.SNAKE_FOOD.size-1),i+(b.SNAKE_FOOD.size-1)])}get x(){return parseInt(this.element.getAttribute("cx"))}set x(t){this.element.setAttribute("cx",Math.floor(t))}get y(){return parseInt(this.element.getAttribute("cy"))}set y(t){this.element.setAttribute("cy",Math.floor(t))}static getNextFoodPosition(){function t(){return Math.floor(Math.random()*(b.SNAKE_FOOD.limits.x-b.SNAKE_FOOD.size))+d.borderWidth+1}function e(){return Math.floor(Math.random()*(b.SNAKE_FOOD.limits.y-b.SNAKE_FOOD.size))+d.borderWidth+1}return new Promise(function(r,n){let o,[s,a]=[t(),e()];o=setInterval(function(r,d,l){try{s%r==0&&a%r==0?(i.clearInterval(o),d({x:s+2,y:a+2})):[s,a]=[t(),e()]}catch(t){n(t)}},0,b.SNAKE.width,r,n)})}drop(){P instanceof K&&K.getNextFoodPosition().then(t=>{P.x=t.x,P.y=t.y})}hide(){this.x=-1,this.y=-1}}let O=function(){let t;return{get:()=>new Promise(function(e,i){try{if(t instanceof v)return e(t);t=function(){let t=m.getFirst();return new v(l,t.position.x,t.position.y,t.direction,b.SNAKE.color)}(),p.log("snake created"),e(t)}catch(t){i(t)}})}}(),P=function(){let t;return{get:()=>new Promise(function(e,i){try{if(t instanceof K)return e(t);new Promise(function(t,e){K.getNextFoodPosition().then(e=>{t(new K(O.arena,e.x,e.y,b.SNAKE_FOOD.color,b.SNAKE_FOOD.size))},t=>{e(t)})}).then(i=>{t=i,p.log("snake food created"),setTimeout(e,1e3*b.SNAKE_FOOD.startAfter,t),e(t)},t=>{p.error(t)})}catch(t){i(t)}})}}();O.get().then(t=>(O=t,P.get()),t=>Promise.reject(t)).then(t=>(P=t,new Promise(function(t,e){try{i.addEventListener("unload",()=>{E()}),r.addEventListener("keydown",function(t){-1!==d.supportedKeys.indexOf(t.keyCode)&&x!=t.keyCode&&t.keyCode!=d.keyConfig[String(x)].reverse&&(x=t.keyCode,m.add({id:Date.now(),direction:t.keyCode,position:{x:O.head.x,y:O.head.y}}))}),t(!0)}catch(t){e(t)}})),t=>Promise.reject(t)).then(t=>{N(b.SNAKE.speed)},t=>{E(),S(e.startGame)})})()}]);