!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);((e={arenaHeight:500,arenaWidth:500})=>{if(!window)return;const t={default:"Sorry.",startGame:"Sorry. Unable To Start The Game"},n=window,i=n.document,r=i.body;r.style.fontFamily="Candara";const[o,s]=["http://www.w3.org/2000/svg","px"],a=function(e){return String(e).trim().concat(this)}.bind(s),d={id:"play-snake-arena",width:e.arenaWidth,height:e.arenaHeight,borderColor:"black",borderWidth:1,limits:{x:e.arenaWidth-1,y:e.arenaHeight-1},supportedKeys:[37,38,39,40],keyConfig:{37:{reverse:39},38:{reverse:40},39:{reverse:37},40:{reverse:38}},pauseButton:{id:"pause-play-snake",text:"Pause",order:"0",clickHandler:function(e){P(),D(),y.log("game paused"),h.setAttribute("disabled","true"),f.hasAttribute("disabled")&&f.removeAttribute("disabled")}},resumeButton:{id:"resume-play-snake",text:"Resume",order:"1",clickHandler:function(e){C(b.SNAKE.speed),B(b.SNAKE_BONUS_FOOD.startAfter),y.log("game resumed"),f.setAttribute("disabled","true"),h.hasAttribute("disabled")&&h.removeAttribute("disabled")}}},u=function(){try{let e=i.createElement("div");e.setAttribute("style","display:flex ; flex-direction:row ; flex-wrap:nowrap; width:"+a(d.width)+"; padding:1% 0%;"),r.appendChild(e);let t="padding:2% 2%; border-radius:5px; flex:0 1 20%; text-align:center; align-self:flex-end;",n=i.createElement("button");n.setAttribute("id",d.pauseButton.id),n.setAttribute("style",t),n.style.order=d.pauseButton.order,n.innerHTML=d.pauseButton.text,e.appendChild(n),n.addEventListener("click",d.pauseButton.clickHandler);let s=i.createElement("button");s.setAttribute("style",t+" margin-left:2%;"),s.setAttribute("id",d.resumeButton.id),s.style.order=d.resumeButton.order,s.innerHTML=d.resumeButton.text,e.appendChild(s),s.addEventListener("click",d.resumeButton.clickHandler);let u=i.createElementNS(o,"svg");u.setAttribute("id",d.id),u.setAttribute("height",d.height),u.setAttribute("width",d.width),u.style.border=a(d.borderWidth)+" solid "+d.borderColor,r.appendChild(u);let c=i.createElement("div");return c.innerHTML='Your Score: <span id="score" style="font-weight: bold;">0</span>',r.appendChild(c),u}catch(e){return!1}}();if(!u)return v("Sorry. Unable to start the game.");class c{constructor(e,t=[]){this.observers=t,this.topic=e}addObserver(e){e.element&&void 0!==e.element.id&&this.observers.push(e)}removeObserver(e){this.observers.splice(this.observers.findIndex(t=>t.element.id===e.element.id),1)}notify(){this.observers.forEach(e=>{e[this.topic]()})}}let l=r.querySelector("#score"),h=r.querySelector("#"+d.pauseButton.id),f=r.querySelector("#"+d.resumeButton.id);const g=new class extends c{constructor(){super("nextXY")}notify(e){super.notify(),e&&1==e&&A.grow(S.drop)}},y={log:console.log,error:console.error};let A,S,x,m,p;const b=function(e){return{SNAKE:{id:e.snakeId,elemType:"rect",width:e.snakeSize,color:e.primaryColor,length:e.snakeLength,speed:e.snakeSpeed,directionMap:{37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},step:1},SNAKE_PART:{idPrefix:e.snakeId+"-part"},SNAKE_FOOD:{id:e.snakeFoodId,elemType:"circle",color:e.secondaryColor,size:Math.floor(e.snakeSize/3),startAfter:2,limits:{x:d.limits.x-e.snakeSize,y:d.limits.y-e.snakeSize},points:e.foodPoints},SNAKE_BONUS_FOOD:{id:e.snakeBonusFoodId,color:e.alertColor,elemType:"circle",size:e.snakeSize,startAfter:30,limits:{x:d.limits.x-2*e.snakeSize,y:d.limits.y-2*e.snakeSize},points:e.bonusFoodPoints,duration:10},ARENA:{center:{x:Math.floor(Math.floor(u.getAttribute("width"))/2),y:Math.floor(Math.floor(u.getAttribute("height"))/2)}}}}({snakeId:"the-snake",snakeFoodId:"the-snake-food",snakeBonusFoodId:"the-snake-bonus-food",snakeSpeed:20,primaryColor:"black",secondaryColor:"grey",alertColor:"red",snakeLength:1,snakeSize:15,foodPoints:5,bonusFoodPoints:10});let N=39;const O=function(e){let t=[];return e&&t.push(e),{add:function(e){let n=t[t.length-1];n&&n.position.x==e.position.x&&n.position.y==e.position.y?n.direction=e.direction:t.push(e)},getFirst:function(){return t[0]},remove:function(){t.shift()},clear:function(){t.splice(0,t.length)},hasCommands:function(){return t.length>0},getNextTurn:function(e){if(void 0===E[e])return this.getFirst();let n=t.findIndex(t=>t.id===E[e]);return n==t.length-1?void 0:t[n+1]}}}({id:Date.now(),direction:N,position:{x:b.ARENA.center.x,y:b.ARENA.center.y}}),E={},k={getSvgNamespace:function(){return o},getDocument:function(){return i},getWindow:function(){return n},getArena:function(){return u},getArenaConfig:function(){return d},getSnake:function(){return A},getSnakeFood:function(){return S},getSnakeBonusFood:function(){return x},getDirectionCommands:function(){return O},getSnakeDirectionMap:function(){return E},pixelify:a},K=function(e,t){return class n{constructor(i,r,o,s=e.SNAKE_FOOD.color,a=e.SNAKE_FOOD.size){t.getSnakeFood()instanceof n||(this.element=(()=>{let n=t.getDocument().createElementNS(t.getSvgNamespace(),e.SNAKE_FOOD.elemType);return n.setAttribute("id",e.SNAKE_FOOD.id),n.setAttribute("cx",r),n.setAttribute("cy",o),n.setAttribute("r",a),n.setAttribute("fill",s),t.getArena().insertBefore(n,t.getSnake().head.element),n})(),this.arena=i,[this.x2,this.y2]=[r+(e.SNAKE_FOOD.size-1),o+(e.SNAKE_FOOD.size-1)])}get x(){return parseInt(this.element.getAttribute("cx"))}set x(e){this.element.setAttribute("cx",Math.floor(e))}get y(){return parseInt(this.element.getAttribute("cy"))}set y(e){this.element.setAttribute("cy",Math.floor(e))}static getNextFoodPosition(){function n(){return Math.floor(Math.random()*(e.SNAKE_FOOD.limits.x-e.SNAKE_FOOD.size))+t.getArenaConfig().borderWidth+1}function i(){return Math.floor(Math.random()*(e.SNAKE_FOOD.limits.y-e.SNAKE_FOOD.size))+t.getArenaConfig().borderWidth+1}return new Promise(function(r,o){let s,[a,d]=[n(),i()];s=setInterval(function(e,r,u){try{a%e==0&&d%e==0?(t.getWindow().clearInterval(s),r({x:a+2,y:d+2})):[a,d]=[n(),i()]}catch(e){o(e)}},0,e.SNAKE.width,r,o)})}drop(){let e=t.getSnakeFood();e instanceof n&&n.getNextFoodPosition().then(t=>{e.x=t.x,e.y=t.y})}hide(){this.x=-10,this.y=-10}}}(b,k),F=function(e,t){return class n{constructor(i,r,o,s=e.SNAKE_BONUS_FOOD.color,a=e.SNAKE_BONUS_FOOD.size){t.getSnakeBonusFood()instanceof n||(this.element=(()=>{let n=t.getDocument().createElementNS(t.getSvgNamespace(),e.SNAKE_BONUS_FOOD.elemType);return n.setAttribute("id",e.SNAKE_BONUS_FOOD.id),n.setAttribute("cx",r),n.setAttribute("cy",o),n.setAttribute("r",a),n.setAttribute("fill",s),t.getArena().insertBefore(n,t.getSnake().head.element),n})(),this.arena=i,[this.x2,this.y2]=[r+(e.SNAKE_BONUS_FOOD.size-1),o+(e.SNAKE_BONUS_FOOD.size-1)])}get x(){return parseInt(this.element.getAttribute("cx"))}set x(e){this.element.setAttribute("cx",Math.floor(e))}get y(){return parseInt(this.element.getAttribute("cy"))}set y(e){this.element.setAttribute("cy",Math.floor(e))}static getNextFoodPosition(){function n(){return Math.floor(Math.random()*(e.SNAKE_BONUS_FOOD.limits.x-e.SNAKE_BONUS_FOOD.size))+t.getArenaConfig().borderWidth+1}function i(){return Math.floor(Math.random()*(e.SNAKE_BONUS_FOOD.limits.y-e.SNAKE_BONUS_FOOD.size))+t.getArenaConfig().borderWidth+1}return new Promise(function(r,o){let s,[a,d]=[n(),i()];s=setInterval(function(e,r,u){try{a%e==0&&d%e==0?(t.getWindow().clearInterval(s),r({x:a+2,y:d+2})):[a,d]=[n(),i()]}catch(e){o(e)}},0,e.SNAKE.width,r,o)})}drop(){t.getSnakeBonusFood()instanceof n&&n.getNextFoodPosition().then(function(n){t.getSnakeBonusFood().x=n.x,t.getSnakeBonusFood().y=n.y,setTimeout(t.getSnakeBonusFood().hide,1e3*e.SNAKE_BONUS_FOOD.duration)})}hide(){t.getSnakeBonusFood().x=-100,t.getSnakeBonusFood().y=-100}}}(b,k),w=function(e,t){return class n{constructor(n,i,r,o,s){let a=t.getSnake().length;this.id=void 0!==a?e.SNAKE.id+"-part"+(t.getSnake().length+1):e.SNAKE.id,this.direction=o,this.element=(()=>{let o=t.getDocument().createElementNS(t.getSvgNamespace(),e.SNAKE.elemType);return o.setAttribute("id",this.id),o.setAttribute("tabIndex",a),o.setAttribute("x",i),o.setAttribute("y",r),o.setAttribute("rx",e.SNAKE.width),o.setAttribute("ry",e.SNAKE.width),o.setAttribute("fill",s),o.setAttribute("width",t.pixelify(e.SNAKE.width)),o.setAttribute("height",t.pixelify(e.SNAKE.width)),n.appendChild(o),o})(),this.color=s,this.next=null,this.prev=null}isSnakeHead(){return this.id===e.SNAKE.id}get x(){return parseInt(this.element.getAttribute("x"))}set x(e){this.element.setAttribute("x",Math.floor(e))}get y(){return parseInt(this.element.getAttribute("y"))}set y(e){this.element.setAttribute("y",Math.floor(e))}get x2(){return this.x+(e.SNAKE.width-1)}get y2(){return this.y+(e.SNAKE.width-1)}isTail(){return this.id===t.getSnake().tail.id}nextXY(){let i={x:this.x,y:this.y};switch(this.direction){case 37:i.x-=e.SNAKE.step;break;case 38:i.y-=e.SNAKE.step;break;case 39:i.x+=e.SNAKE.step;break;case 40:i.y+=e.SNAKE.step}if(i=n.checkBoundaryPosition(this.direction,i),this.x=i.x,this.y=i.y,t.getDirectionCommands().hasCommands()){let e=t.getDirectionCommands().getNextTurn(this.id);e&&e.position.x==this.x&&e.position.y==this.y&&(this.direction=e.direction,t.getSnakeDirectionMap()[this.id]=e.id,this.isTail()&&t.getDirectionCommands().remove())}}getXYOfNextPart(){let[t,n]=[this.x,this.y];switch(this.direction){case 37:t+=e.SNAKE.width;break;case 38:n+=e.SNAKE.width;break;case 39:t-=e.SNAKE.width;break;case 40:n-=e.SNAKE.width}return{x:t,y:n}}static checkBoundaryPosition(n,i){switch(n){case 37:i.x<t.getArenaConfig().borderWidth&&(i.x=t.getArenaConfig().limits.x-e.SNAKE.width);break;case 38:i.y<t.getArenaConfig().borderWidth&&(i.y=t.getArenaConfig().limits.y-e.SNAKE.width);break;case 39:i.x+e.SNAKE.width>t.getArenaConfig().limits.x&&(i.x=t.getArenaConfig().borderWidth);break;case 40:i.y+e.SNAKE.width>t.getArenaConfig().limits.y&&(i.y=t.getArenaConfig().borderWidth)}return i}}}(b,k);function v(e){n.alert(e)}function _(){A=null,P(),S=null,x=null,D()}function D(){n.clearInterval(p)}function B(e){p=setInterval(x.drop,1e3*e)}function C(e){m=setInterval(function(){let e=N;A.changeDirection(e),A.start()},e)}function P(){n.clearInterval(m)}function M(e){l.innerHTML=+l.innerHTML+e}class I{constructor(e,t,n,i,r=b.SNAKE.color){this.head=new w(e,t,n,i,r),this.tail=this.head,this.arena=e,this.UP=function(){this.move(0,-1*b.SNAKE.step)},this.DOWN=function(){this.move(0,b.SNAKE.step)},this.RIGHT=function(){this.move(b.SNAKE.step,0)},this.LEFT=function(){this.move(-1*b.SNAKE.step,0)},this.turningPoints=[],this.length=1}changeDirection(e){this.head.direction=e}grow(e){let{x:t,y:n}=this.tail.getXYOfNextPart(),i=new w(A.arena,t,n,this.tail.direction,this.tail.color);this.tail.next=i,i.prev=this.tail,this.tail=i,this.length+=1,g.addObserver(this.tail),M(b.SNAKE_FOOD.points),"function"==typeof e&&e()}changeColor(e){let t=this.head;for(;null!==t.next;)n(t,e),t=t.next;function n(e,t){setTimeout(()=>{e.color=t},0)}}start(){this[b.SNAKE.directionMap[String(this.head.direction)]]()}isEatingFood(){let e=this.head;return e.x<S.x&&S.x<e.x2&&e.y<S.y&&S.y<e.y2&&(S.hide(),!0)}isEatingBonusFood(){let e=this.head,t=x.x-b.SNAKE_BONUS_FOOD.size-1,n=x.x+b.SNAKE_BONUS_FOOD.size-1,i=x.y-b.SNAKE_BONUS_FOOD.size-1,r=x.y+b.SNAKE_BONUS_FOOD.size-1;return t<e.x&&e.x<n&&i<e.y&&e.y<r}move(e,t){let i=this.head,[r,o]=[i.x,i.y],{x:s,y:a}=w.checkBoundaryPosition(i.direction,{x:r+e,y:o+t});if(this.isEatingItself())return n.alert("GAME OVER\nYou Scored "+l.innerHTML+" points."),void _();i.x=s,i.y=a;let d=this.isEatingFood();this.isEatingBonusFood()&&(x.hide(),M(b.SNAKE_BONUS_FOOD.points)),this.moveAllParts(d)}moveAllParts(e){1===this.length&&O.clear(),g.notify(e)}isEatingItself(){let e=!1,t=A.head.next,n=A.head.direction;for(;null!==t;){if(t.direction!==n||t.id===A.tail.id){switch(n){case 37:A.head.y===t.y&&A.head.x>t.x&&A.head.x<=t.x2&&(e=!0);break;case 38:A.head.x===t.x&&A.head.y>t.y&&A.head.y<=t.y2&&(e=!0);break;case 39:A.head.y===t.y&&A.head.x2<t.x2&&A.head.x2>=t.x&&(e=!0);break;case 40:A.head.x===t.x&&A.head.y2<t.y2&&A.head.y2>=t.y&&(e=!0)}if(e)break}t=t.next}return!!e}}A=function(){let e;return{get:()=>new Promise(function(t,n){try{if(e instanceof I)return t(e);e=function(){let e=O.getFirst();return new I(u,e.position.x,e.position.y,e.direction,b.SNAKE.color)}(),y.log("snake created"),t(e)}catch(e){n(e)}})}}(),S=function(){let e;return{get:()=>new Promise(function(t,n){try{if(e instanceof K)return t(e);new Promise(function(e,t){K.getNextFoodPosition().then(function(t){e(new K(A.arena,t.x,t.y,b.SNAKE_FOOD.color,b.SNAKE_FOOD.size))},function(e){t(e)})}).then(function(n){e=n,setTimeout(t,1e3*b.SNAKE_FOOD.startAfter,e),t(e)},function(e){y.error(e)})}catch(e){n(e)}})}}(),x=function(){let e;return{get:()=>new Promise(function(t,n){try{if(e instanceof F)return t(e);new Promise(function(e,t){F.getNextFoodPosition().then(function(t){e(new F(A.arena,t.x,t.y))},function(e){})}).then(function(n){t(e=n)})}catch(e){n(e)}})}}(),A.get().then(function(e){return A=e,S.get()},e=>Promise.reject(e)).then(function(e){return S=e,x.get().then(function(e){x=e,B(b.SNAKE_BONUS_FOOD.startAfter)},function(e){}),new Promise(function(e,t){try{n.addEventListener("unload",()=>{_()}),i.addEventListener("keydown",function(e){-1!==d.supportedKeys.indexOf(e.keyCode)&&N!=e.keyCode&&e.keyCode!=d.keyConfig[String(N)].reverse&&(N=e.keyCode,O.add({id:Date.now(),direction:e.keyCode,position:{x:A.head.x,y:A.head.y}}))}),e(!0)}catch(e){t(e)}})},e=>Promise.reject(e)).then(function(e){C(b.SNAKE.speed)},function(e){_(),v(t.startGame)})})()}]);